{
    "collab_server" : "",
    "contents" : "library(shiny)\nlibrary(ggmap)\nlibrary(ggplot2)\n#library(\"tm\")\n#library(\"SnowballC\")\n#library(\"wordcloud\")\n#library(\"RColorBrewer\")\n\nshinyServer(\n  function(input,output,session)\n  {\n    output$listingplot <- renderPlot(\n      {\n        if(input$Attributes == \"Location\")\n        {\n          newlistings <- subset(listings,\n                                listings$neighbourhood_cleansed == input$InputLocation,\n                                select = c(\"latitude\",\n                                           \"longitude\",\n                                           \"property_type\",\n                                           \"transformed_price\",\n                                           \"neighbourhood_cleansed\"))\n          NLdataframe <- data.frame(newlistings)\n          bostonmap <- get_map(location = c(lon = -71.0589, \n                                            lat = 42.3601), \n                               zoom = 15, \n                               maptype = \"roadmap\",\n                               source = \"google\")\n          displaymap <- ggmap(bostonmap,extent = \"normal\", maprange = TRUE) + geom_point(data= NLdataframe,\n                                                      aes(x=longitude, \n                                                          y=latitude),\n                                                      colour = \"blue\")\n          displaymap\n          #plot(newlistings$longitude,newlistings$latitude,col=\"blue\")\n          #hist(newlistings$transformed_price)\n        }\n        else if(input$Attributes == \"Property Type\")\n        {\n          newlistings <- subset(listings,\n                                listings$property_type == input$InputPropertyType,\n                                select = c(\"latitude\",\n                                           \"longitude\",\n                                           \"property_type\",\n                                           \"transformed_price\",\n                                           \"neighbourhood_cleansed\"))\n          NLdataframe <- data.frame(newlistings)\n          bostonmap <- get_map(location = c(lon = -71.0589, \n                                            lat = 42.3601), \n                               zoom = 15, \n                               maptype = \"roadmap\",\n                               source = \"google\")\n          displaymap <- ggmap(bostonmap,extent = \"normal\", maprange = TRUE) + geom_point(data= NLdataframe,\n                                                      aes(x=longitude, \n                                                          y=latitude),\n                                                      colour = \"red\")\n          displaymap\n          #plot(newlistings$longitude,newlistings$latitude,col=\"red\")\n          #hist(newlistings$transformed_price)\n        }\n        else if(input$Attributes == \"Rate\")\n        {\n          newlistings <- subset(listings,\n                                listings$transformed_price <= input$InputRate,\n                                select = c(\"latitude\",\n                                           \"longitude\",\n                                           \"property_type\",\n                                           \"transformed_price\",\n                                           \"neighbourhood_cleansed\"))\n          NLdataframe <- data.frame(newlistings)\n          bostonmap <- get_map(location = c(lon = -71.0589, \n                                            lat = 42.3601), \n                               zoom = 15, \n                               maptype = \"roadmap\",\n                               source = \"google\")\n          displaymap <- ggmap(bostonmap, extent = \"normal\", maprange = TRUE) + geom_point(data= NLdataframe,\n                                                      aes(x=longitude, \n                                                          y=latitude),\n                                                      colour = \"green\")\n          displaymap\n          #plot(newlistings$longitude,newlistings$latitude,col=\"green\")\n          #hist(newlistings$transformed_price)\n        }\n      }\n    )\n  output$summarytable <- renderPrint(\n    {\n      if(input$Attributes == \"Location\")\n      {\n        newlistings <- subset(listings,\n                              listings$neighbourhood_cleansed == input$InputLocation,\n                              select = c(\"transformed_price\",\n                                         \"bedrooms\",\n                                         \"bathrooms\",\n                                         \"number_of_reviews\"))\n        #plot(newlistings$longitude,newlistings$latitude,col=\"blue\")\n        summary(newlistings)\n      }\n      else if(input$Attributes == \"Property Type\")\n      {\n        newlistings <- subset(listings,\n                              listings$property_type == input$InputPropertyType,\n                              select = c(\"transformed_price\",\n                                         \"bedrooms\",\n                                         \"bathrooms\",\n                                         \"number_of_reviews\"))\n        #plot(newlistings$l ongitude,newlistings$latitude,col=\"red\")\n        summary(newlistings)\n      }\n      else if(input$Attributes == \"Rate\")\n      {\n        newlistings <- subset(listings,\n                              listings$transformed_price <= input$InputRate,\n                              select = c(\"transformed_price\",\n                                         \"bedrooms\",\n                                         \"bathrooms\",\n                                         \"number_of_reviews\"))\n        #plot(newlistings$longitude,newlistings$latitude,col=\"green\")\n        summary(newlistings)\n      }\n    }\n  )\n  output$ReviewOut <- renderPrint(\n  {\n    if(input$Attributes == \"Location\")\n    {\n      reviewdf <- subset(listings,\n                            listings$neighbourhood_cleansed == input$InputLocation,\n                            select = c(\"summary\"))\n      data.frame(reviewdf)\n    }\n    else if(input$Attributes == \"Property Type\")\n    {\n      reviewdf <- subset(listings,\n                            listings$property_type == input$InputPropertyType,\n                            select = c(\"summary\"))\n      data.frame(reviewdf)\n    }\n    else if(input$Attributes == \"Rate\")\n    {\n      reviewdf <- subset(listings,\n                            listings$transformed_price <= input$InputRate,\n                            select = c(\"summary\"))\n      data.frame(reviewdf)\n    }\n  }\n)\n  }\n)\n\n",
    "created" : 1509540629176.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3057293350",
    "id" : "DF5D6BC9",
    "lastKnownWriteTime" : 1509602009,
    "last_content_update" : 1509602009043,
    "path" : "C:/B14 - Applied Statistical Analysis with R/Projects/Boston AirBnB/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}